{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "FuncParamSelector": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "FuncParamSelector"
        },
        "index": {
          "type": "integer"
        }
      },
      "required": [
        "type",
        "index"
      ]
    },
    "StateVarSelector": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "StateVarSelector"
        },
        "anchor_fn": {
          "type": "string"
        },
        "keys": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/FuncParamSelector"
              },
              {
                "type": "string"
              }
            ]
          },
          "default": []
        }
      },
      "required": [
        "type",
        "anchor_fn"
      ]
    },
    "FnCallRetSelector": {
      "description": "Select the return value of a function call.",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "FnCallRetSelector"
        },
        "fn_name": {
          "type": "string"
        }
      },
      "required": [
        "type",
        "fn_name"
      ]
    },
    "ConstantSelector": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "ConstantSelector"
        },
        "value": {
          "oneOf": [
            {
              "type": "boolean"
            },
            {
              "type": "integer"
            },
            {
              "type": "string"
            }
          ]
        }
      },
      "required": [
        "type",
        "value"
      ]
    },
    "MsgSenderSelector": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "MsgSenderSelector"
        }
      },
      "required": [
        "type"
      ]
    },
    "CompCondition": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "CompCondition"
        },
        "left": {
          "oneOf": [
            {
              "$ref": "#/definitions/FuncParamSelector"
            },
            {
              "$ref": "#/definitions/ConstantSelector"
            },
            {
              "$ref": "#/definitions/StateVarSelector"
            }
          ]
        },
        "right": {
          "oneOf": [
            {
              "$ref": "#/definitions/FuncParamSelector"
            },
            {
              "$ref": "#/definitions/ConstantSelector"
            },
            {
              "$ref": "#/definitions/StateVarSelector"
            }
          ]
        },
        "op": {
          "type": "string",
          "enum": [
            "not_eq",
            "eq",
            "gt",
            "lt",
            "gte",
            "lte"
          ]
        }
      },
      "required": [
        "type",
        "left",
        "right",
        "op"
      ]
    },
    "WrittenCondition": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "WrittenCondition"
        },
        "value": {
          "$ref": "#/definitions/StateVarSelector"
        },
        "change_type": {
          "type": "string",
          "enum": [
            "increase",
            "decrease",
            "change"
          ],
          "default": "change"
        },
        "written_cnt": {
          "type": "string",
          "enum": [
            "one"
          ],
          "default": null,
          "description": "The number of times the state variable is written to. If state variable is related to balance and written count is one and change type is increase,  this infers token creation"
        }
      },
      "required": [
        "type",
        "value"
      ]
    },
    "ArrLengthSelector": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "ArrLengthSelector"
        },
        "value": {
          "$ref": "#/definitions/FuncParamSelector"
        }
      },
      "required": [
        "type",
        "value"
      ]
    },
    "LogicCondition": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "LogicCondition"
        },
        "cond": {
          "type": "array",
          "items": {
            "oneOf": [
              {
                "$ref": "#/definitions/CompCondition"
              },
              {
                "$ref": "#/definitions/WrittenCondition"
              },
              {
                "$ref": "#/definitions/CompCondition"
              }
            ]
          }
        },
        "op": {
          "type": "string",
          "enum": [
            "and",
            "or"
          ]
        }
      }
    },
    "ThrowVerify": {
      "type": "object",
      "description": "Do not use post-execution state to construct the condition.",
      "properties": {
        "type": {
          "type": "string",
          "const": "ThrowVerify"
        },
        "cond": {
          "oneOf": [
            {
              "$ref": "#/definitions/CompCondition"
            },
            {
              "$ref": "#/definitions/LogicCondition"
            }
          ]
        },
        "op": {
          "type": "string",
          "enum": [
            "throw",
            "not_throw"
          ],
          "default": "throw"
        }
      },
      "required": [
        "type",
        "cond",
        "op"
      ]
    }
  },
  "type": "object",
  "properties": {
    "ThrowVerify": {
      "$ref": "#/definitions/ThrowVerify"
    }
  }
}